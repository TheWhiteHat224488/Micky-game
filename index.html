<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Thought Walk</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #f9fafb;
      overflow: hidden;
      background: #020617;
    }

    #game {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      transition: background 0.9s ease;
    }

    /* Global states for different worlds */
    body.world-forest #game {
      background: radial-gradient(circle at 10% 0%, #172554 0, #020617 60%, #020617 100%);
    }

    body.world-thoughts #game {
      background:
        radial-gradient(circle at 10% 0%, rgba(244, 114, 182, 0.35), transparent 55%),
        radial-gradient(circle at 80% 100%, rgba(56, 189, 248, 0.35), transparent 60%),
        radial-gradient(circle at 50% 30%, rgba(129, 140, 248, 0.45), transparent 60%),
        linear-gradient(160deg, #020617, #0f172a, #1e293b);
    }

    body.world-memory #game {
      background:
        radial-gradient(circle at 0% 0%, rgba(251, 191, 36, 0.3), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(248, 250, 252, 0.2), transparent 65%),
        linear-gradient(145deg, #0f172a, #1f2937, #111827);
      filter: none;
    }

    body.world-future #game {
      background:
        radial-gradient(circle at 0% 0%, rgba(96, 165, 250, 0.4), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(52, 211, 153, 0.4), transparent 55%),
        linear-gradient(135deg, #020617, #0f172a, #020617);
    }

    /* Forest layer (intro + doors) */
    .forest-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      transition: opacity 0.8s ease, transform 0.9s ease;
      z-index: 1;
    }

    body.world-thoughts .forest-layer,
    body.world-memory .forest-layer,
    body.world-future .forest-layer {
      opacity: 0;
      transform: scale(1.08);
    }

    .forest-ground {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 30%;
      background:
        radial-gradient(circle at 50% -20%, rgba(34, 197, 94, 0.25), transparent 65%),
        linear-gradient(#14532d, #022c22);
    }

    .stars {
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(2px 2px at 10% 20%, rgba(248, 250, 252, 0.8), transparent),
        radial-gradient(1.5px 1.5px at 60% 15%, rgba(244, 244, 245, 0.7), transparent),
        radial-gradient(1.8px 1.8px at 80% 35%, rgba(226, 232, 240, 0.7), transparent),
        radial-gradient(2px 2px at 30% 5%, rgba(248, 250, 252, 0.7), transparent),
        radial-gradient(1.5px 1.5px at 40% 40%, rgba(248, 250, 252, 0.5), transparent);
      opacity: 0.7;
      animation: twinkle 6s infinite alternate;
    }

    @keyframes twinkle {
      0% { opacity: 0.5; }
      100% { opacity: 0.9; }
    }

    .tree {
      position: absolute;
      bottom: 15%;
      width: 40px;
      height: 120px;
    }

    .tree .trunk {
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 12px;
      height: 45px;
      transform: translateX(-50%);
      background: linear-gradient(#4b2e12, #1f1309);
      border-radius: 999px;
    }

    .tree .crown {
      position: absolute;
      bottom: 25px;
      left: 50%;
      width: 90px;
      height: 80px;
      transform: translateX(-50%);
      background:
        radial-gradient(circle at 30% 15%, #bbf7d0, transparent 60%),
        radial-gradient(circle at 70% 10%, #6ee7b7, transparent 65%),
        radial-gradient(circle at 50% 60%, #16a34a, transparent 70%);
      border-radius: 999px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.6);
    }

    .bush {
      position: absolute;
      bottom: 10%;
      width: 80px;
      height: 40px;
      background:
        radial-gradient(circle at 30% 20%, #bbf7d0, transparent 60%),
        radial-gradient(circle at 60% 25%, #4ade80, transparent 65%),
        radial-gradient(circle at 50% 80%, #16a34a, transparent 70%);
      border-radius: 999px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.6);
    }

    .fireflies {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .firefly {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(250, 250, 210, 0.9);
      box-shadow: 0 0 12px rgba(250, 250, 210, 0.9);
      animation: drift 8s ease-in-out infinite alternate;
      opacity: 0.85;
    }

    @keyframes drift {
      0% { transform: translateY(0) translateX(0); opacity: 0.4; }
      50% { opacity: 0.9; }
      100% { transform: translateY(-40px) translateX(20px); opacity: 0.5; }
    }

    /* Zoom animation when starting */
    #game.zooming {
      animation: zoomInForest 0.9s ease forwards;
    }

    @keyframes zoomInForest {
      0% { transform: scale(1); }
      100% { transform: scale(1.07); }
    }

    /* Scenes */
    .scene {
      position: relative;
      z-index: 2;
      max-width: 700px;
      width: 100%;
      padding: 24px;
      border-radius: 24px;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.96));
      box-shadow:
        0 24px 80px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(148, 163, 184, 0.15);
      backdrop-filter: blur(18px);
      opacity: 0;
      transform: translateY(12px) scale(0.98);
      pointer-events: none;
      transition: opacity 0.35s ease, transform 0.35s ease;
    }

    .scene.active {
      opacity: 1;
      transform: translateY(0) scale(1);
      pointer-events: auto;
    }

    h1 {
      font-size: clamp(1.7rem, 3vw, 2.2rem);
      margin-bottom: 0.4rem;
      letter-spacing: 0.03em;
    }

    .subtitle {
      font-size: 0.95rem;
      color: #e5e7eb;
      opacity: 0.9;
      margin-bottom: 1.6rem;
      line-height: 1.5;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: rgba(15, 118, 110, 0.18);
      border: 1px solid rgba(45, 212, 191, 0.4);
      color: #a5f3fc;
      margin-bottom: 1rem;
    }

    .pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.9);
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 1.3rem;
    }

    button {
      cursor: pointer;
      border: none;
      outline: none;
    }

    .btn-primary {
      padding: 10px 18px;
      border-radius: 999px;
      font-weight: 500;
      background: radial-gradient(circle at 0% 0%, #22c55e, #14b8a6);
      color: #022c22;
      font-size: 0.95rem;
      box-shadow:
        0 12px 30px rgba(34, 197, 94, 0.35),
        0 0 0 1px rgba(34, 197, 94, 0.6);
      transition: transform 0.15s ease, box-shadow 0.15s ease, filter 0.15s ease;
    }

    .btn-primary:hover {
      transform: translateY(-1px) scale(1.01);
      box-shadow:
        0 16px 40px rgba(34, 197, 94, 0.45),
        0 0 0 1px rgba(22, 163, 74, 0.8);
      filter: brightness(1.03);
    }

    .btn-secondary {
      padding: 9px 16px;
      border-radius: 999px;
      font-size: 0.9rem;
      background: rgba(15, 23, 42, 0.6);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.6);
      transition: background 0.15s ease, transform 0.15s ease, border-color 0.15s ease;
    }

    .btn-secondary:hover {
      background: rgba(30, 64, 175, 0.6);
      transform: translateY(-1px);
      border-color: rgba(191, 219, 254, 0.9);
    }

    /* Doors scene */
    .doors-layout {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 16px;
      margin-top: 1.4rem;
    }

    @media (max-width: 720px) {
      .doors-layout {
        grid-template-columns: 1fr;
      }
    }

    .door {
      position: relative;
      padding: 16px 12px 18px;
      border-radius: 18px;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.97));
      border: 1px solid rgba(148, 163, 184, 0.6);
      box-shadow:
        0 12px 30px rgba(15, 23, 42, 0.85),
        inset 0 0 0 1px rgba(15, 23, 42, 0.9);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 8px;
      text-align: left;
      transition: transform 0.17s ease, box-shadow 0.17s ease, border-color 0.17s ease, background 0.2s ease;
    }

    .door:hover {
      transform: translateY(-4px);
      box-shadow:
        0 18px 40px rgba(15, 23, 42, 0.98),
        0 0 0 1px rgba(248, 250, 252, 0.15);
      border-color: rgba(248, 250, 252, 0.35);
      background: radial-gradient(circle at top, rgba(30, 64, 175, 0.85), rgba(15, 23, 42, 0.98));
    }

    .door-label {
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #bfdbfe;
    }

    .door-title {
      font-size: 1.05rem;
      font-weight: 600;
      color: #e5e7eb;
    }

    .door-description {
      font-size: 0.85rem;
      color: #cbd5f5;
      opacity: 0.95;
      line-height: 1.4;
    }

    .door-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 4px 8px;
      font-size: 0.7rem;
      margin-top: 4px;
      background: rgba(15, 23, 42, 0.9);
      color: #a5f3fc;
    }

    .door-tag-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }

    /* World scene */
    .world-header {
      font-size: 0.85rem;
      letter-spacing: 0.13em;
      text-transform: uppercase;
      color: #a5b4fc;
      margin-bottom: 0.3rem;
    }

    .world-title {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
    }

    .world-description {
      font-size: 0.9rem;
      color: #e5e7eb;
      opacity: 0.95;
      margin-bottom: 1.1rem;
      line-height: 1.5;
    }

    .question-card {
      padding: 14px 14px 12px;
      border-radius: 18px;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.94), rgba(2, 6, 23, 0.96));
      border: 1px solid rgba(148, 163, 184, 0.7);

      /* centered changes */
      margin: 0.8rem auto;
      max-width: 520px;
      text-align: center;
    }

    .question-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.11em;
      margin-bottom: 0.2rem;
      color: #a5b4fc;
    }

    .question-text {
      font-size: 0.95rem;
      color: #e5e7eb;
    }

    textarea {
      width: 100%;
      min-height: 110px;
      margin-top: 0.9rem;
      padding: 10px 11px;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.9);
      color: #f9fafb;
      font-size: 0.9rem;
      resize: vertical;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;

      /* centered changes */
      display: block;
      margin-left: auto;
      margin-right: auto;
      max-width: 520px;
    }

    textarea:focus {
      border-color: rgba(59, 130, 246, 0.9);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.7);
      background: rgba(15, 23, 42, 0.96);
    }

    .hint-text {
      margin-top: 0.4rem;
      font-size: 0.8rem;
      color: #9ca3af;
      text-align: center; /* centered */
    }

    .world-footer-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.9rem;
      gap: 8px;
      flex-wrap: wrap;
    }

    .world-footnote {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    /* Little sparkles overlay for worlds */
    .world-sparkles {
      pointer-events: none;
      position: absolute;
      inset: 0;
      opacity: 0;
      mix-blend-mode: screen;
      background-image:
        radial-gradient(3px 3px at 20% 10%, rgba(244, 244, 245, 0.9), transparent),
        radial-gradient(3px 3px at 80% 30%, rgba(253, 244, 255, 0.9), transparent),
        radial-gradient(2px 2px at 40% 80%, rgba(244, 244, 245, 0.9), transparent);
      animation: sparkleFloat 8s ease-in-out infinite alternate;
      z-index: 1;
    }

    body.world-thoughts .world-sparkles,
    body.world-future .world-sparkles {
      opacity: 0.7;
    }

    @keyframes sparkleFloat {
      0% { transform: translateY(0); opacity: 0.4; }
      100% { transform: translateY(-16px); opacity: 0.9; }
    }
  </style>
</head>
<body class="world-forest">
  <div id="game">
    <div class="world-sparkles"></div>

    <!-- Forest background -->
    <div class="forest-layer">
      <div class="stars"></div>
      <div class="forest-ground"></div>

      <!-- Trees -->
      <div class="tree" style="left: 8%;">
        <div class="trunk"></div>
        <div class="crown"></div>
      </div>
      <div class="tree" style="left: 26%; transform: scale(1.15);">
        <div class="trunk"></div>
        <div class="crown"></div>
      </div>
      <div class="tree" style="left: 47%; transform: scale(1.3);">
        <div class="trunk"></div>
        <div class="crown"></div>
      </div>
      <div class="tree" style="left: 68%; transform: scale(1.1);">
        <div class="trunk"></div>
        <div class="crown"></div>
      </div>
      <div class="tree" style="left: 86%; transform: scale(0.95);">
        <div class="trunk"></div>
        <div class="crown"></div>
      </div>

      <!-- Bushes -->
      <div class="bush" style="left: 12%; transform: scale(0.95);"></div>
      <div class="bush" style="left: 32%; transform: scale(0.9);"></div>
      <div class="bush" style="left: 52%; transform: scale(1);"></div>
      <div class="bush" style="left: 72%; transform: scale(1.05);"></div>
      <div class="bush" style="left: 88%; transform: scale(0.9);"></div>

      <!-- Fireflies -->
      <div class="fireflies">
        <div class="firefly" style="left: 20%; top: 40%; animation-delay: 0s;"></div>
        <div class="firefly" style="left: 35%; top: 30%; animation-delay: 1s;"></div>
        <div class="firefly" style="left: 60%; top: 38%; animation-delay: 1.8s;"></div>
        <div class="firefly" style="left: 75%; top: 26%; animation-delay: 2.4s;"></div>
        <div class="firefly" style="left: 45%; top: 52%; animation-delay: 3.1s;"></div>
      </div>
    </div>

    <!-- Intro scene -->
    <section class="scene scene-intro active">
      <div class="pill">
        <span class="pill-dot"></span>
        Take a small walk with your thoughts
      </div>

      <h1>Thoughts, memories, and your future self.</h1>
      <p class="subtitle">
        You’re not alone in this new chapter. Let’s walk through what’s on your mind,
        what you’re carrying from the past, and where you want to go next.
      </p>

      <p class="subtitle" style="font-size: 0.88rem; opacity: 0.85;">
        Pick a door when you’re ready – each one is its own little world.
      </p>

      <div class="btn-row">
        <button class="btn-primary" id="startBtn">Start walking</button>
        <button class="btn-secondary" id="introSkipBtn">
          Jump straight to the doors
        </button>
      </div>
    </section>

    <!-- Doors scene -->
    <section class="scene scene-doors">
      <div class="pill">
        <span class="pill-dot"></span>
        Choose your first world
      </div>

      <h1>Three doors, three worlds.</h1>
      <p class="subtitle">
        Each door is a different kind of reflection. There’s no “right” order –
        choose the one that feels most like you right now.
      </p>

      <div class="doors-layout">
        <!-- Thoughts door -->
        <button class="door" data-world="thoughts">
          <div class="door-label">Door one</div>
          <div class="door-title">Thoughts</div>
          <div class="door-description">
            What’s actually on your mind tonight – worries, hopes, random overthinking, anything.
          </div>
          <div class="door-tag">
            <span class="door-tag-dot"></span>
            Inside your head
          </div>
        </button>

        <!-- Memory door -->
        <button class="door" data-world="memory">
          <div class="door-label">Door two</div>
          <div class="door-title">Memory</div>
          <div class="door-description">
            Moments that stayed with you, the good and the heavy ones, and what they’re still whispering.
          </div>
          <div class="door-tag">
            <span class="door-tag-dot"></span>
            Looking back
          </div>
        </button>

        <!-- Future door -->
        <button class="door" data-world="future">
          <div class="door-label">Door three</div>
          <div class="door-title">Future</div>
          <div class="door-description">
            The “you” you want to become, and the life that secretly feels right when you imagine it.
          </div>
          <div class="door-tag">
            <span class="door-tag-dot"></span>
            Looking ahead
          </div>
        </button>
      </div>

      <div class="btn-row" style="margin-top: 1.4rem; justify-content: flex-end;">
        <button class="btn-secondary" id="backToIntroBtn">Back to forest</button>
      </div>
    </section>

    <!-- World scene -->
    <section class="scene scene-world">
      <div class="world-header" id="worldHeaderLabel">
        World
      </div>
      <div class="world-title" id="worldTitle">
        World of Thoughts
      </div>
      <p class="world-description" id="worldDescription">
        This is your space to spill whatever has been sitting at the top of your mind lately.
      </p>

      <div class="question-card">
        <div class="question-label" id="questionLabel">
          First step
        </div>
        <div class="question-text" id="questionText">
          What’s one thing you’re feeling about this new chapter right now?
        </div>
      </div>

      <textarea id="worldAnswer" placeholder="Write anything here – it doesn’t have to sound smart or perfect."></textarea>

      <div class="hint-text" id="worldHint">
        You don’t have to write a lot. Even one messy sentence is enough.
      </div>

      <div class="world-footer-row">
        <div class="world-footnote" id="worldFootnote">
          You can always come back and change this later.
        </div>
        <div class="btn-row">
          <button class="btn-secondary" id="backToDoorsBtn">Back to doors</button>
          <button class="btn-primary" id="nextWorldBtn">Next world</button>
        </div>
      </div>
    </section>
  </div>

  <script>
    const scenes = {
      intro: document.querySelector(".scene-intro"),
      doors: document.querySelector(".scene-doors"),
      world: document.querySelector(".scene-world"),
    };

    const game = document.getElementById("game");

    const startBtn = document.getElementById("startBtn");
    const introSkipBtn = document.getElementById("introSkipBtn");
    const backToIntroBtn = document.getElementById("backToIntroBtn");
    const backToDoorsBtn = document.getElementById("backToDoorsBtn");
    const nextWorldBtn = document.getElementById("nextWorldBtn");

    const doorButtons = document.querySelectorAll(".door");

    const worldHeaderLabel = document.getElementById("worldHeaderLabel");
    const worldTitle = document.getElementById("worldTitle");
    const worldDescription = document.getElementById("worldDescription");
    const questionLabel = document.getElementById("questionLabel");
    const questionText = document.getElementById("questionText");
    const worldAnswer = document.getElementById("worldAnswer");
    const worldHint = document.getElementById("worldHint");
    const worldFootnote = document.getElementById("worldFootnote");

    const worlds = {
      thoughts: {
        bodyClass: "world-thoughts",
        header: "Door 1 • World of thoughts",
        title: "Inside your thoughts.",
        description:
          "This is the dreamy, floaty place where your thoughts just exist – even the chaotic and confusing ones.",
        questionLabel: "First step",
        question:
          "What’s one thing you’re honestly feeling about this new chapter right now?",
        placeholder:
          "Dump whatever is in your head – even if it feels small, dramatic, or silly.",
        hint:
          "Don’t edit yourself. Imagine you’re writing to a future you who really gets it.",
        footnote: "You can always come back to this world and add more later.",
      },
      memory: {
        bodyClass: "world-memory",
        header: "Door 2 • World of memory",
        title: "The moments that stayed.",
        description:
          "Some memories sit like screenshots in your mind. Good, bad, or mixed – they still shape how you feel today.",
        questionLabel: "Looking back",
        question:
          "Is there one memory that keeps coming back to you lately? Why do you think it shows up?",
        placeholder:
          "Write about a moment, a day, or even a tiny scene that you can’t stop replaying.",
        hint:
          "You don’t have to write every detail. Just the parts that feel loud or heavy.",
        footnote: "You’re not judging the memory – you’re just noticing it.",
      },
      future: {
        bodyClass: "world-future",
        header: "Door 3 • World of future you",
        title: "The version of you that’s coming.",
        description:
          "This world is about the you that feels right when you imagine them – even if you’re not there yet.",
        questionLabel: "Looking ahead",
        question:
          "If future-you walked into the room right now, how would you want them to feel about life?",
        placeholder:
          "Describe how you want your future self to live, feel, or move through the day.",
        hint:
          "Think vibes and feelings, not just goals. Calm? Proud? Free? Surrounded by who?",
        footnote: "Even small steps count toward that version of you.",
      },
    };

    const answers = {
      thoughts: "",
      memory: "",
      future: "",
    };

    const worldOrder = ["thoughts", "memory", "future"];
    let currentWorldIndex = 0;
    let linearJourney = false;

    function setBodyWorld(className) {
      document.body.classList.remove(
        "world-forest",
        "world-thoughts",
        "world-memory",
        "world-future"
      );
      document.body.classList.add(className);
    }

    function showScene(name) {
      Object.values(scenes).forEach((scene) => scene.classList.remove("active"));
      if (scenes[name]) {
        scenes[name].classList.add("active");
      }
    }

    function openWorld(worldKey) {
      const config = worlds[worldKey];
      if (!config) return;

      setBodyWorld(config.bodyClass);

      worldHeaderLabel.textContent = config.header;
      worldHeaderLabel.dataset.worldKey = worldKey;
      worldTitle.textContent = config.title;
      worldDescription.textContent = config.description;
      questionLabel.textContent = config.questionLabel;
      questionText.textContent = config.question;
      worldAnswer.placeholder = config.placeholder;
      worldHint.textContent = config.hint;
      worldFootnote.textContent = config.footnote;

      worldAnswer.value = answers[worldKey] || "";

      // Update Next button text depending on where we are
      if (linearJourney) {
        const index = worldOrder.indexOf(worldKey);
        currentWorldIndex = index !== -1 ? index : 0;
        if (currentWorldIndex === worldOrder.length - 1) {
          nextWorldBtn.textContent = "Finish journey";
        } else {
          nextWorldBtn.textContent = "Next world";
        }
      } else {
        nextWorldBtn.textContent = "Next world";
      }

      showScene("world");
    }

    // Start walking -> zoom -> linear door journey (Thoughts -> Memory -> Future)
    startBtn.addEventListener("click", () => {
      linearJourney = true;
      game.classList.add("zooming");

      setTimeout(() => {
        game.classList.remove("zooming");
        currentWorldIndex = 0;
        const firstWorld = worldOrder[currentWorldIndex];
        openWorld(firstWorld);
      }, 850);
    });

    // Jump straight to doors (classic choices)
    introSkipBtn.addEventListener("click", () => {
      linearJourney = false;
      setBodyWorld("world-forest");
      showScene("doors");
    });

    backToIntroBtn.addEventListener("click", () => {
      linearJourney = false;
      setBodyWorld("world-forest");
      showScene("intro");
    });

    backToDoorsBtn.addEventListener("click", () => {
      const currentWorldKey = worldHeaderLabel.dataset.worldKey;
      if (currentWorldKey && worlds[currentWorldKey]) {
        answers[currentWorldKey] = worldAnswer.value;
      }
      linearJourney = false;
      setBodyWorld("world-forest");
      showScene("doors");
    });

    // Next world button (only makes sense in linear mode)
    nextWorldBtn.addEventListener("click", () => {
      const currentWorldKey = worldHeaderLabel.dataset.worldKey;
      if (currentWorldKey && worlds[currentWorldKey]) {
        answers[currentWorldKey] = worldAnswer.value;
      }

      if (!linearJourney) {
        // If not in linear mode, just go back to doors
        setBodyWorld("world-forest");
        showScene("doors");
        return;
      }

      if (currentWorldIndex < worldOrder.length - 1) {
        currentWorldIndex += 1;
        const nextKey = worldOrder[currentWorldIndex];
        openWorld(nextKey);
      } else {
        // Finished all three doors
        linearJourney = false;
        setBodyWorld("world-forest");
        showScene("doors");
      }
    });

    // Door buttons still work like portals
    doorButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const worldKey = btn.dataset.world;
        linearJourney = false; // manual choice mode
        openWorld(worldKey);
      });
    });

    // Initial state
    showScene("intro");
    setBodyWorld("world-forest");
  </script>
</body>
</html>
